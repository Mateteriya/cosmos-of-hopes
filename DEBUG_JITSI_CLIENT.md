# Диагностика проблемы: участники не создают конференции

## Проблема
Участники подключаются к prosody, но не создают MUC-комнаты. Конференции не инициализируются.

## Диагностика на стороне клиента

### 1. Проверить URL в браузере

Откройте консоль браузера (F12) и проверьте:
- Какой URL используется для Jitsi
- Есть ли ошибки JavaScript
- Есть ли ошибки CORS

### 2. Проверить переменную окружения

Убедитесь, что `NEXT_PUBLIC_JITSI_SERVER_URL` установлена правильно:
```bash
# На сервере проверьте .env.local или переменные окружения
echo $NEXT_PUBLIC_JITSI_SERVER_URL
```

Должно быть:
```
NEXT_PUBLIC_JITSI_SERVER_URL=https://meet.super2026.online
```

### 3. Проверить логи браузера

В консоли браузера (F12 → Console) при входе в комнату должны быть сообщения от Jitsi. Ищите:
- Ошибки подключения
- Ошибки XMPP
- Ошибки создания конференции

### 4. Проверить Network вкладку

В браузере (F12 → Network) проверьте:
- Запросы к `meet.super2026.online`
- Запросы к `/http-bind` или `/xmpp-websocket`
- Есть ли ошибки 4xx или 5xx

## Возможные решения

### Решение 1: Проверить конфигурацию nginx

Убедитесь, что nginx правильно проксирует запросы к Jitsi:

```bash
# Проверить конфигурацию nginx для Jitsi
cat /etc/nginx/sites-enabled/meet.super2026.online | grep -A 20 "location"
```

### Решение 2: Временно использовать публичный сервер

Для теста измените в коде:
```typescript
const jitsiServerUrl = 'https://meet.jit.si'; // Временно для теста
```

Если с публичным сервером работает - проблема в конфигурации вашего сервера.

### Решение 3: Проверить CORS настройки

Убедитесь, что CORS настроен правильно в nginx для Jitsi домена.

### Решение 4: Проверить что конфигурационный файл доступен

```bash
# Проверить что конфигурационный файл доступен через веб
curl -I https://meet.super2026.online/config.js
```

Должен вернуть 200 OK.

## Что проверить в логах prosody

При входе участника должны появляться сообщения о создании MUC комнаты:

```bash
tail -f /var/log/prosody/prosody.log | grep -E "muc|conference|presence|room"
```

Если таких сообщений нет - клиент не отправляет запросы на создание конференции.

